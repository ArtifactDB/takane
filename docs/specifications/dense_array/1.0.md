

# Dense array (1.0)

## Overview

The `dense_array` format provides an on-disk representation of a dense array.

## Object metadata

The `OBJECT` file should contain a `dense_array` property, itself a JSON object with the following properties:

- `version`, a string specifying the version of the `dense_array` format.
  This should be set to "1.0".

## Directory structure

The directory should contain an `array.h5` HDF5 file, which in turn should contain a `dense_array` group.
The group should contain `data`, an N-dimensional dataset containing the values of the dense array.
This should have a `type` attribute specifying the type of the dense array and the expected HDF5 datatype of the dataset itself:

- For `type = "integer"` or `"boolean"`, the datatype should be any integer type that can be exactly represented by a 32-bit signed integer.
  Check out the [HDF5 policy draft (v0.1.0)](https://github.com/ArtifactDB/Bioc-HDF5-policy/tree/v0.1.0) for more details.
- For `type = "number"`, the datatype should be any integer/float type that can be exactly represented by a 64-bit float.
- For `type = "string"`, the datatype should be any string type that can be represented by a UTF-8 encoded string.

Missing values in the matrix are represented by placeholder values, defined in the `missing-value-placeholder` attribute of the `dense_array/data` dataset.
The attribute should be scalar and should have the same datatype as `dense_array/data`, except in the case of strings where any string datatype may be used.
All values in the dataset equal to the placeholder should be treated as missing.
See the [HDF5 policy draft (v0.1.0)](https://github.com/ArtifactDB/Bioc-HDF5-policy/tree/v0.1.0) for details.

Optionally, the `dense_array` group may contain a `names` subgroup.
This may contain any number of 1-dimensional string datasets named after the corresponding dimension of `dense_array/data`, e.g., `0` for the first dimension, `1` for the second dimension, and so on.
Each dataset contains the names for its dimension and should have a length equal to the extent of that dimension.
Any HDF5 string datatype may be used in each dataset.

Optionally, the `dense_array` group may have a `transposed` attribute.
This should be scalar and have a datatype that can be exactly represented by a 32-bit signed integer.
Any non-zero value indicates that the dense array is stored in a transposed format,
i.e., the first HDF5 dimension is actually the last dimension in the original array.
This is necessary for efficiently reading/writing from frameworks that use, e.g., column-major layouts to represent matrices, as opposed to HDF5's row-major layout.

## Height

The height of the dense array is defined as the extent of the first dimension in the `dense_array/data` dataset of `array.h5`.
If the array is transposed, the extent of the last dimension is used instead.

## Dimensions

The dimensions of the dense array are defined as the dimensions of the `dense_array/data` dataset of `array.h5`.
If the array is transposed, the dimensions are reversed.
